{
  "hash": "1aebda216de9dcee05129d75d4e87a79",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"フィルタ・セレクト・アレンジ\"\n---\n\n\n\n\n## `dplyr` 基本操作：データの選択、並べ替え、整形\n\nでは、`dplyr` パッケージの中心的な機能である「データのサブセット化」と「順序の整理」を紹介します。\n`tidyverse` を読み込んで、R に組み込まれている `starwars` データセットを使いながら、以下の4つの基本的な「動詞」をマスターしましょう。\n\n- select(): 列を選ぶ\n- filter(): 行を絞り込む\n- arrange(): 行を並べ替える\n- relocate(): 列の順序を変更する\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n\n## `select()`: 列を選ぶ\n\n`select()` は、ティブル (tibble) から必要な列だけを選び出すための関数です。\n\n分析に必要な列だけを残したり、特定の列を除外したりする場合に使います。\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# starwarsデータから、名前、身長、体重の列だけを選ぶ\nstarwars |> select(name, height, mass)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 87 × 3\n   name               height  mass\n   <chr>               <int> <dbl>\n 1 Luke Skywalker        172    77\n 2 C-3PO                 167    75\n 3 R2-D2                  96    32\n 4 Darth Vader           202   136\n 5 Leia Organa           150    49\n 6 Owen Lars             178   120\n 7 Beru Whitesun Lars    165    75\n 8 R5-D4                  97    32\n 9 Biggs Darklighter     183    84\n10 Obi-Wan Kenobi        182    77\n# ℹ 77 more rows\n```\n\n\n:::\n\n```{.r .cell-code}\n# name列からmass列まで、連続した列を選ぶ\nstarwars |> select(name:mass)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 87 × 3\n   name               height  mass\n   <chr>               <int> <dbl>\n 1 Luke Skywalker        172    77\n 2 C-3PO                 167    75\n 3 R2-D2                  96    32\n 4 Darth Vader           202   136\n 5 Leia Organa           150    49\n 6 Owen Lars             178   120\n 7 Beru Whitesun Lars    165    75\n 8 R5-D4                  97    32\n 9 Biggs Darklighter     183    84\n10 Obi-Wan Kenobi        182    77\n# ℹ 77 more rows\n```\n\n\n:::\n\n```{.r .cell-code}\n# hair_color列を「除外」する\nstarwars |> select(-hair_color)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 87 × 13\n   name      height  mass skin_color eye_color birth_year sex   gender homeworld\n   <chr>      <int> <dbl> <chr>      <chr>          <dbl> <chr> <chr>  <chr>    \n 1 Luke Sky…    172    77 fair       blue            19   male  mascu… Tatooine \n 2 C-3PO        167    75 gold       yellow         112   none  mascu… Tatooine \n 3 R2-D2         96    32 white, bl… red             33   none  mascu… Naboo    \n 4 Darth Va…    202   136 white      yellow          41.9 male  mascu… Tatooine \n 5 Leia Org…    150    49 light      brown           19   fema… femin… Alderaan \n 6 Owen Lars    178   120 light      blue            52   male  mascu… Tatooine \n 7 Beru Whi…    165    75 light      blue            47   fema… femin… Tatooine \n 8 R5-D4         97    32 white, red red             NA   none  mascu… Tatooine \n 9 Biggs Da…    183    84 light      brown           24   male  mascu… Tatooine \n10 Obi-Wan …    182    77 fair       blue-gray       57   male  mascu… Stewjon  \n# ℹ 77 more rows\n# ℹ 4 more variables: species <chr>, films <list>, vehicles <list>,\n#   starships <list>\n```\n\n\n:::\n\n```{.r .cell-code}\n# \"color\"で終わる名前の列をすべて選ぶ\nstarwars |> select(ends_with(\"color\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 87 × 3\n   hair_color    skin_color  eye_color\n   <chr>         <chr>       <chr>    \n 1 blond         fair        blue     \n 2 <NA>          gold        yellow   \n 3 <NA>          white, blue red      \n 4 none          white       yellow   \n 5 brown         light       brown    \n 6 brown, grey   light       blue     \n 7 brown         light       blue     \n 8 <NA>          white, red  red      \n 9 black         light       brown    \n10 auburn, white fair        blue-gray\n# ℹ 77 more rows\n```\n\n\n:::\n:::\n\n\n### `select()` で使える便利なヘルパー関数\n\n`select()` で一つずつ列の名前を指定するのは、列が多い場合に大変です。\n`dplyr` には、特定のパターンに一致する列名を効率よく選ぶためのヘルパー関数が用意されており、これらを `select()` や {relocate()} の中で使うことができます。\n\n- `everything()`: まだ選択されていない残りのすべての列を選びます。\n- `starts_with()`: 指定した文字で始まる名前の列をすべて選びます。\n- `ends_with()`: 指定した文字で終わる名前の列をすべて選びます。\n- `contains()`: 名前に指定した文字が含まれる列をすべて選びます（位置は問いません）。\n- `matches()`: 正規表現 (Regular Expression) という、文字列の高度なパターンマッチング言語を使って列名を選びます。`contains()` などが単純な単語を探すのに対し、`matches()` は「`A` または `B` を含む」や「`s` で始まり `t` で終わる」といった、より複雑なルールを指定できます。\n- `where()`: 列のデータ型（数値、文字列など）に基づいて列を選ぶ、少し高度ですが強力なヘルパーです。\n  - where(is.numeric): 数値型の列をすべて選びます。\n  - where(is.character): 文字列型の列をすべて選びます。\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 文字列型の列をすべて選ぶ\nstarwars |> select(where(is.character))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 87 × 8\n   name           hair_color skin_color eye_color sex   gender homeworld species\n   <chr>          <chr>      <chr>      <chr>     <chr> <chr>  <chr>     <chr>  \n 1 Luke Skywalker blond      fair       blue      male  mascu… Tatooine  Human  \n 2 C-3PO          <NA>       gold       yellow    none  mascu… Tatooine  Droid  \n 3 R2-D2          <NA>       white, bl… red       none  mascu… Naboo     Droid  \n 4 Darth Vader    none       white      yellow    male  mascu… Tatooine  Human  \n 5 Leia Organa    brown      light      brown     fema… femin… Alderaan  Human  \n 6 Owen Lars      brown, gr… light      blue      male  mascu… Tatooine  Human  \n 7 Beru Whitesun… brown      light      blue      fema… femin… Tatooine  Human  \n 8 R5-D4          <NA>       white, red red       none  mascu… Tatooine  Droid  \n 9 Biggs Darklig… black      light      brown     male  mascu… Tatooine  Human  \n10 Obi-Wan Kenobi auburn, w… fair       blue-gray male  mascu… Stewjon   Human  \n# ℹ 77 more rows\n```\n\n\n:::\n:::\n\n\n## `filter()`: 行を絞り込む\n\n`filter()` は、指定した条件に一致する行だけを絞り込むための関数です。\n\nデータの特定のサブセット（例：特定の種族のキャラクター、特定の条件を満たす観測など）を抽出する際に使います。\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 種族 (species) が \"Human\" のキャラクターだけを絞り込む\nstarwars |> filter(species == \"Human\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 35 × 14\n   name     height  mass hair_color skin_color eye_color birth_year sex   gender\n   <chr>     <int> <dbl> <chr>      <chr>      <chr>          <dbl> <chr> <chr> \n 1 Luke Sk…    172    77 blond      fair       blue            19   male  mascu…\n 2 Darth V…    202   136 none       white      yellow          41.9 male  mascu…\n 3 Leia Or…    150    49 brown      light      brown           19   fema… femin…\n 4 Owen La…    178   120 brown, gr… light      blue            52   male  mascu…\n 5 Beru Wh…    165    75 brown      light      blue            47   fema… femin…\n 6 Biggs D…    183    84 black      light      brown           24   male  mascu…\n 7 Obi-Wan…    182    77 auburn, w… fair       blue-gray       57   male  mascu…\n 8 Anakin …    188    84 blond      fair       blue            41.9 male  mascu…\n 9 Wilhuff…    180    NA auburn, g… fair       blue            64   male  mascu…\n10 Han Solo    180    80 brown      fair       brown           29   male  mascu…\n# ℹ 25 more rows\n# ℹ 5 more variables: homeworld <chr>, species <chr>, films <list>,\n#   vehicles <list>, starships <list>\n```\n\n\n:::\n\n```{.r .cell-code}\n# 身長 (height) が180cmより大きいキャラクターを絞り込む\nstarwars |> filter(height > 180)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 39 × 14\n   name     height  mass hair_color skin_color eye_color birth_year sex   gender\n   <chr>     <int> <dbl> <chr>      <chr>      <chr>          <dbl> <chr> <chr> \n 1 Darth V…    202 136   none       white      yellow          41.9 male  mascu…\n 2 Biggs D…    183  84   black      light      brown           24   male  mascu…\n 3 Obi-Wan…    182  77   auburn, w… fair       blue-gray       57   male  mascu…\n 4 Anakin …    188  84   blond      fair       blue            41.9 male  mascu…\n 5 Chewbac…    228 112   brown      unknown    blue           200   male  mascu…\n 6 Boba Fe…    183  78.2 black      fair       brown           31.5 male  mascu…\n 7 IG-88       200 140   none       metal      red             15   none  mascu…\n 8 Bossk       190 113   none       green      red             53   male  mascu…\n 9 Qui-Gon…    193  89   brown      fair       blue            92   male  mascu…\n10 Nute Gu…    191  90   none       mottled g… red             NA   male  mascu…\n# ℹ 29 more rows\n# ℹ 5 more variables: homeworld <chr>, species <chr>, films <list>,\n#   vehicles <list>, starships <list>\n```\n\n\n:::\n\n```{.r .cell-code}\n# 複数の条件を組み合わせる (種族がHuman「かつ」出身惑星がTatooine)\n# カンマ(,)は「かつ」(AND) を意味します\nstarwars |>  filter(species == \"Human\", homeworld == \"Tatooine\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 8 × 14\n  name      height  mass hair_color skin_color eye_color birth_year sex   gender\n  <chr>      <int> <dbl> <chr>      <chr>      <chr>          <dbl> <chr> <chr> \n1 Luke Sky…    172    77 blond      fair       blue            19   male  mascu…\n2 Darth Va…    202   136 none       white      yellow          41.9 male  mascu…\n3 Owen Lars    178   120 brown, gr… light      blue            52   male  mascu…\n4 Beru Whi…    165    75 brown      light      blue            47   fema… femin…\n5 Biggs Da…    183    84 black      light      brown           24   male  mascu…\n6 Anakin S…    188    84 blond      fair       blue            41.9 male  mascu…\n7 Shmi Sky…    163    NA black      fair       brown           72   fema… femin…\n8 Cliegg L…    183    NA brown      fair       blue            82   male  mascu…\n# ℹ 5 more variables: homeworld <chr>, species <chr>, films <list>,\n#   vehicles <list>, starships <list>\n```\n\n\n:::\n\n```{.r .cell-code}\n# 複数の条件のいずれかを満たす (髪の色が \"blond\" 「または」 \"brown\")\n# | は「または」(OR) を意味します\nstarwars |>  filter(hair_color == \"blond\" | hair_color == \"brown\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 21 × 14\n   name     height  mass hair_color skin_color eye_color birth_year sex   gender\n   <chr>     <int> <dbl> <chr>      <chr>      <chr>          <dbl> <chr> <chr> \n 1 Luke Sk…    172    77 blond      fair       blue            19   male  mascu…\n 2 Leia Or…    150    49 brown      light      brown           19   fema… femin…\n 3 Beru Wh…    165    75 brown      light      blue            47   fema… femin…\n 4 Anakin …    188    84 blond      fair       blue            41.9 male  mascu…\n 5 Chewbac…    228   112 brown      unknown    blue           200   male  mascu…\n 6 Han Solo    180    80 brown      fair       brown           29   male  mascu…\n 7 Wedge A…    170    77 brown      fair       hazel           21   male  mascu…\n 8 Jek Ton…    180   110 brown      fair       blue            NA   <NA>  <NA>  \n 9 Arvel C…     NA    NA brown      fair       brown           NA   male  mascu…\n10 Wicket …     88    20 brown      brown      brown            8   male  mascu…\n# ℹ 11 more rows\n# ℹ 5 more variables: homeworld <chr>, species <chr>, films <list>,\n#   vehicles <list>, starships <list>\n```\n\n\n:::\n:::\n\n\n## `filter()` のヘルパー関数\n\n- `is.na()`: データ分析では欠損値 `NA` (Not Available) の扱いは非常に重要です。`is.na()` を使うと、特定の列が `NA` である行、あるいは `NA` ではない行を簡単に絞り込めます。\n- `str_detect()`: `stringr` パッケージ (`tidyverse` に含まれる) の関数で、文字列の中に 特定のパターンが含まれているか を判定します。完全一致 (==) よりも柔軟な検索が可能です。\n- `between()`: 数値がある範囲の 間にあるか を判定します。列名 >= 最小値 & 列名 <= 最大値 と書くよりも直感的で分かりやすいです。\n- `%in%`: `|` (または) を何度も書く代わりに、指定した複数の値の いずれかに含まれるか を判定します。コードが非常にすっきりと読みやすくなります。\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstarwars |> filter(is.na(mass))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 28 × 14\n   name     height  mass hair_color skin_color eye_color birth_year sex   gender\n   <chr>     <int> <dbl> <chr>      <chr>      <chr>          <dbl> <chr> <chr> \n 1 Wilhuff…    180    NA auburn, g… fair       blue              64 male  mascu…\n 2 Mon Mot…    150    NA auburn     fair       blue              48 fema… femin…\n 3 Arvel C…     NA    NA brown      fair       brown             NA male  mascu…\n 4 Finis V…    170    NA blond      fair       blue              91 male  mascu…\n 5 Rugor N…    206    NA none       green      orange            NA male  mascu…\n 6 Ric Olié    183    NA brown      fair       blue              NA male  mascu…\n 7 Watto       137    NA black      blue, grey yellow            NA male  mascu…\n 8 Quarsh …    183    NA black      dark       brown             62 male  mascu…\n 9 Shmi Sk…    163    NA black      fair       brown             72 fema… femin…\n10 Bib For…    180    NA none       pale       pink              NA male  mascu…\n# ℹ 18 more rows\n# ℹ 5 more variables: homeworld <chr>, species <chr>, films <list>,\n#   vehicles <list>, starships <list>\n```\n\n\n:::\n\n```{.r .cell-code}\nstarwars |> filter(!is.na(mass))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 59 × 14\n   name     height  mass hair_color skin_color eye_color birth_year sex   gender\n   <chr>     <int> <dbl> <chr>      <chr>      <chr>          <dbl> <chr> <chr> \n 1 Luke Sk…    172    77 blond      fair       blue            19   male  mascu…\n 2 C-3PO       167    75 <NA>       gold       yellow         112   none  mascu…\n 3 R2-D2        96    32 <NA>       white, bl… red             33   none  mascu…\n 4 Darth V…    202   136 none       white      yellow          41.9 male  mascu…\n 5 Leia Or…    150    49 brown      light      brown           19   fema… femin…\n 6 Owen La…    178   120 brown, gr… light      blue            52   male  mascu…\n 7 Beru Wh…    165    75 brown      light      blue            47   fema… femin…\n 8 R5-D4        97    32 <NA>       white, red red             NA   none  mascu…\n 9 Biggs D…    183    84 black      light      brown           24   male  mascu…\n10 Obi-Wan…    182    77 auburn, w… fair       blue-gray       57   male  mascu…\n# ℹ 49 more rows\n# ℹ 5 more variables: homeworld <chr>, species <chr>, films <list>,\n#   vehicles <list>, starships <list>\n```\n\n\n:::\n\n```{.r .cell-code}\n#  | をたくさん使う例\nstarwars |> \n  filter(name == \"Luke Skywalker\" | name == \"R2-D2\" | name == \"Darth Vader\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 14\n  name      height  mass hair_color skin_color eye_color birth_year sex   gender\n  <chr>      <int> <dbl> <chr>      <chr>      <chr>          <dbl> <chr> <chr> \n1 Luke Sky…    172    77 blond      fair       blue            19   male  mascu…\n2 R2-D2         96    32 <NA>       white, bl… red             33   none  mascu…\n3 Darth Va…    202   136 none       white      yellow          41.9 male  mascu…\n# ℹ 5 more variables: homeworld <chr>, species <chr>, films <list>,\n#   vehicles <list>, starships <list>\n```\n\n\n:::\n\n```{.r .cell-code}\n# %in% を使うバージョン\ntarget_characters <- c(\"Luke Skywalker\", \"R2-D2\", \"Darth Vader\")\nstarwars |> filter(name %in% target_characters)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 14\n  name      height  mass hair_color skin_color eye_color birth_year sex   gender\n  <chr>      <int> <dbl> <chr>      <chr>      <chr>          <dbl> <chr> <chr> \n1 Luke Sky…    172    77 blond      fair       blue            19   male  mascu…\n2 R2-D2         96    32 <NA>       white, bl… red             33   none  mascu…\n3 Darth Va…    202   136 none       white      yellow          41.9 male  mascu…\n# ℹ 5 more variables: homeworld <chr>, species <chr>, films <list>,\n#   vehicles <list>, starships <list>\n```\n\n\n:::\n\n```{.r .cell-code}\n# \"R[0-9]-D[0-9]\"の正規表現に絞り込む\nstarwars |> filter(str_detect(name, \"R[0-9]-D[0-9]\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 14\n  name  height  mass hair_color skin_color  eye_color birth_year sex   gender   \n  <chr>  <int> <dbl> <chr>      <chr>       <chr>          <dbl> <chr> <chr>    \n1 R2-D2     96    32 <NA>       white, blue red               33 none  masculine\n2 R5-D4     97    32 <NA>       white, red  red               NA none  masculine\n# ℹ 5 more variables: homeworld <chr>, species <chr>, films <list>,\n#   vehicles <list>, starships <list>\n```\n\n\n:::\n\n```{.r .cell-code}\n# mass が 90 から 120 の間の時に絞り込む\nstarwars |> filter(between(mass, 90, 120))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 14\n  name      height  mass hair_color skin_color eye_color birth_year sex   gender\n  <chr>      <int> <dbl> <chr>      <chr>      <chr>          <dbl> <chr> <chr> \n1 Owen Lars    178   120 brown, gr… light      blue              52 male  mascu…\n2 Chewbacca    228   112 brown      unknown    blue             200 male  mascu…\n3 Jek Tono…    180   110 brown      fair       blue              NA <NA>  <NA>  \n4 Bossk        190   113 none       green      red               53 male  mascu…\n5 Nute Gun…    191    90 none       mottled g… red               NA male  mascu…\n6 Dexter J…    198   102 none       brown      yellow            NA male  mascu…\n# ℹ 5 more variables: homeworld <chr>, species <chr>, films <list>,\n#   vehicles <list>, starships <list>\n```\n\n\n:::\n\n```{.r .cell-code}\n# mass が NA の時に絞り込む\nstarwars |>  filter(is.na(mass))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 28 × 14\n   name     height  mass hair_color skin_color eye_color birth_year sex   gender\n   <chr>     <int> <dbl> <chr>      <chr>      <chr>          <dbl> <chr> <chr> \n 1 Wilhuff…    180    NA auburn, g… fair       blue              64 male  mascu…\n 2 Mon Mot…    150    NA auburn     fair       blue              48 fema… femin…\n 3 Arvel C…     NA    NA brown      fair       brown             NA male  mascu…\n 4 Finis V…    170    NA blond      fair       blue              91 male  mascu…\n 5 Rugor N…    206    NA none       green      orange            NA male  mascu…\n 6 Ric Olié    183    NA brown      fair       blue              NA male  mascu…\n 7 Watto       137    NA black      blue, grey yellow            NA male  mascu…\n 8 Quarsh …    183    NA black      dark       brown             62 male  mascu…\n 9 Shmi Sk…    163    NA black      fair       brown             72 fema… femin…\n10 Bib For…    180    NA none       pale       pink              NA male  mascu…\n# ℹ 18 more rows\n# ℹ 5 more variables: homeworld <chr>, species <chr>, films <list>,\n#   vehicles <list>, starships <list>\n```\n\n\n:::\n\n```{.r .cell-code}\n# mass が NA じゃない時に絞り込む\nstarwars |>  filter(!is.na(mass))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 59 × 14\n   name     height  mass hair_color skin_color eye_color birth_year sex   gender\n   <chr>     <int> <dbl> <chr>      <chr>      <chr>          <dbl> <chr> <chr> \n 1 Luke Sk…    172    77 blond      fair       blue            19   male  mascu…\n 2 C-3PO       167    75 <NA>       gold       yellow         112   none  mascu…\n 3 R2-D2        96    32 <NA>       white, bl… red             33   none  mascu…\n 4 Darth V…    202   136 none       white      yellow          41.9 male  mascu…\n 5 Leia Or…    150    49 brown      light      brown           19   fema… femin…\n 6 Owen La…    178   120 brown, gr… light      blue            52   male  mascu…\n 7 Beru Wh…    165    75 brown      light      blue            47   fema… femin…\n 8 R5-D4        97    32 <NA>       white, red red             NA   none  mascu…\n 9 Biggs D…    183    84 black      light      brown           24   male  mascu…\n10 Obi-Wan…    182    77 auburn, w… fair       blue-gray       57   male  mascu…\n# ℹ 49 more rows\n# ℹ 5 more variables: homeworld <chr>, species <chr>, films <list>,\n#   vehicles <list>, starships <list>\n```\n\n\n:::\n:::\n\n\n## `arrange()`: 行を並べ替える\n\n`arrange()` は、指定した列の値に基づいて行の順序を並べ替えるための関数です。\n\nデフォルトでは昇順（小さい順、アルファベット順）に並べ替えます。降順にするには `desc()` を使います。\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 体重 (mass) が軽い順に並べ替える\nstarwars |> arrange(mass)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 87 × 14\n   name     height  mass hair_color skin_color eye_color birth_year sex   gender\n   <chr>     <int> <dbl> <chr>      <chr>      <chr>          <dbl> <chr> <chr> \n 1 Ratts T…     79    15 none       grey, blue unknown           NA male  mascu…\n 2 Yoda         66    17 white      green      brown            896 male  mascu…\n 3 Wicket …     88    20 brown      brown      brown              8 male  mascu…\n 4 R2-D2        96    32 <NA>       white, bl… red               33 none  mascu…\n 5 R5-D4        97    32 <NA>       white, red red               NA none  mascu…\n 6 Sebulba     112    40 none       grey, red  orange            NA male  mascu…\n 7 Padmé A…    185    45 brown      light      brown             46 fema… femin…\n 8 Dud Bolt     94    45 none       blue, grey yellow            NA male  mascu…\n 9 Wat Tam…    193    48 none       green, gr… unknown           NA male  mascu…\n10 Sly Moo…    178    48 none       pale       white             NA <NA>  <NA>  \n# ℹ 77 more rows\n# ℹ 5 more variables: homeworld <chr>, species <chr>, films <list>,\n#   vehicles <list>, starships <list>\n```\n\n\n:::\n\n```{.r .cell-code}\n# 身長 (height) が高い順に並べ替える\nstarwars |> arrange(desc(height))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 87 × 14\n   name     height  mass hair_color skin_color eye_color birth_year sex   gender\n   <chr>     <int> <dbl> <chr>      <chr>      <chr>          <dbl> <chr> <chr> \n 1 Yarael …    264    NA none       white      yellow          NA   male  mascu…\n 2 Tarfful     234   136 brown      brown      blue            NA   male  mascu…\n 3 Lama Su     229    88 none       grey       black           NA   male  mascu…\n 4 Chewbac…    228   112 brown      unknown    blue           200   male  mascu…\n 5 Roos Ta…    224    82 none       grey       orange          NA   male  mascu…\n 6 Grievous    216   159 none       brown, wh… green, y…       NA   male  mascu…\n 7 Taun We     213    NA none       grey       black           NA   fema… femin…\n 8 Rugor N…    206    NA none       green      orange          NA   male  mascu…\n 9 Tion Me…    206    80 none       grey       black           NA   male  mascu…\n10 Darth V…    202   136 none       white      yellow          41.9 male  mascu…\n# ℹ 77 more rows\n# ℹ 5 more variables: homeworld <chr>, species <chr>, films <list>,\n#   vehicles <list>, starships <list>\n```\n\n\n:::\n\n```{.r .cell-code}\n# 複数の列で並べ替える (種族で並べ替え、同じ種族の中では身長が高い順に並べ替える)\nstarwars |> arrange(species, desc(height))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 87 × 14\n   name     height  mass hair_color skin_color eye_color birth_year sex   gender\n   <chr>     <int> <dbl> <chr>      <chr>      <chr>          <dbl> <chr> <chr> \n 1 Ratts T…     79    15 none       grey, blue unknown           NA male  mascu…\n 2 Dexter …    198   102 none       brown      yellow            NA male  mascu…\n 3 Ki-Adi-…    198    82 white      pale       yellow            92 male  mascu…\n 4 Mas Ame…    196    NA none       blue       blue              NA male  mascu…\n 5 Zam Wes…    168    55 blonde     fair, gre… yellow            NA fema… femin…\n 6 IG-88       200   140 none       metal      red               15 none  mascu…\n 7 C-3PO       167    75 <NA>       gold       yellow           112 none  mascu…\n 8 R5-D4        97    32 <NA>       white, red red               NA none  mascu…\n 9 R2-D2        96    32 <NA>       white, bl… red               33 none  mascu…\n10 R4-P17       96    NA none       silver, r… red, blue         NA none  femin…\n# ℹ 77 more rows\n# ℹ 5 more variables: homeworld <chr>, species <chr>, films <list>,\n#   vehicles <list>, starships <list>\n```\n\n\n:::\n:::\n\n\n## `relocate()`: 列の順序を変更する\n\n`relocate()` は、データフレームの列の順序を自由に変更するための関数です。\n\n特定の列を先頭に持ってきたり、関連する列を隣同士に並べたりして、データをみやすくするのに役立ちます。\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# `homeworld` と `species` の列を先頭に移動する\nstarwars |> relocate(homeworld, species)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 87 × 14\n   homeworld species name           height  mass hair_color skin_color eye_color\n   <chr>     <chr>   <chr>           <int> <dbl> <chr>      <chr>      <chr>    \n 1 Tatooine  Human   Luke Skywalker    172    77 blond      fair       blue     \n 2 Tatooine  Droid   C-3PO             167    75 <NA>       gold       yellow   \n 3 Naboo     Droid   R2-D2              96    32 <NA>       white, bl… red      \n 4 Tatooine  Human   Darth Vader       202   136 none       white      yellow   \n 5 Alderaan  Human   Leia Organa       150    49 brown      light      brown    \n 6 Tatooine  Human   Owen Lars         178   120 brown, gr… light      blue     \n 7 Tatooine  Human   Beru Whitesun…    165    75 brown      light      blue     \n 8 Tatooine  Droid   R5-D4              97    32 <NA>       white, red red      \n 9 Tatooine  Human   Biggs Darklig…    183    84 black      light      brown    \n10 Stewjon   Human   Obi-Wan Kenobi    182    77 auburn, w… fair       blue-gray\n# ℹ 77 more rows\n# ℹ 6 more variables: birth_year <dbl>, sex <chr>, gender <chr>, films <list>,\n#   vehicles <list>, starships <list>\n```\n\n\n:::\n\n```{.r .cell-code}\n# `birth_year` 列を `name` 列のすぐ後ろに移動する\nstarwars |> relocate(birth_year, .after = name)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 87 × 14\n   name     birth_year height  mass hair_color skin_color eye_color sex   gender\n   <chr>         <dbl>  <int> <dbl> <chr>      <chr>      <chr>     <chr> <chr> \n 1 Luke Sk…       19      172    77 blond      fair       blue      male  mascu…\n 2 C-3PO         112      167    75 <NA>       gold       yellow    none  mascu…\n 3 R2-D2          33       96    32 <NA>       white, bl… red       none  mascu…\n 4 Darth V…       41.9    202   136 none       white      yellow    male  mascu…\n 5 Leia Or…       19      150    49 brown      light      brown     fema… femin…\n 6 Owen La…       52      178   120 brown, gr… light      blue      male  mascu…\n 7 Beru Wh…       47      165    75 brown      light      blue      fema… femin…\n 8 R5-D4          NA       97    32 <NA>       white, red red       none  mascu…\n 9 Biggs D…       24      183    84 black      light      brown     male  mascu…\n10 Obi-Wan…       57      182    77 auburn, w… fair       blue-gray male  mascu…\n# ℹ 77 more rows\n# ℹ 5 more variables: homeworld <chr>, species <chr>, films <list>,\n#   vehicles <list>, starships <list>\n```\n\n\n:::\n\n```{.r .cell-code}\n# `gender` 列を `homeworld` 列のすぐ前に移動する\nstarwars |> relocate(gender, .before = homeworld)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 87 × 14\n   name     height  mass hair_color skin_color eye_color birth_year sex   gender\n   <chr>     <int> <dbl> <chr>      <chr>      <chr>          <dbl> <chr> <chr> \n 1 Luke Sk…    172    77 blond      fair       blue            19   male  mascu…\n 2 C-3PO       167    75 <NA>       gold       yellow         112   none  mascu…\n 3 R2-D2        96    32 <NA>       white, bl… red             33   none  mascu…\n 4 Darth V…    202   136 none       white      yellow          41.9 male  mascu…\n 5 Leia Or…    150    49 brown      light      brown           19   fema… femin…\n 6 Owen La…    178   120 brown, gr… light      blue            52   male  mascu…\n 7 Beru Wh…    165    75 brown      light      blue            47   fema… femin…\n 8 R5-D4        97    32 <NA>       white, red red             NA   none  mascu…\n 9 Biggs D…    183    84 black      light      brown           24   male  mascu…\n10 Obi-Wan…    182    77 auburn, w… fair       blue-gray       57   male  mascu…\n# ℹ 77 more rows\n# ℹ 5 more variables: homeworld <chr>, species <chr>, films <list>,\n#   vehicles <list>, starships <list>\n```\n\n\n:::\n:::\n\n\n## 演習：すべてを繋げてみよう\n\n`starwars` データセットを使って、以下の条件を満たすデータを作成してください。\n\n1. 種族が \"Droid\" のキャラクターだけを絞り込み (`filter`)、\n2. `name`, `model`, `mass`, `birth_year` の列だけを選び (`select`)、\n3. `mass` が重い順に並べ替え (`arrange`)、\n4. `model` 列を先頭に移動させて (`relocate`) ください。\n\n\n\n\n\n\n\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}