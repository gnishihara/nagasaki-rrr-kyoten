---
title: "散布図"
---

```{r}
#| include: false
library(tidyverse)
```

## `ggplot2` の基礎：`geom_point()` で散布図を描く

`ggplot2` で作図する際の基本は、レイヤー（層）を `+` で重ねていくことです。
まずは、最も基本的なグラフである散布図を作成し、その過程で `ggplot2` の「文法」に慣れていきましょう。

ここでは、R に組み込まれている `iris` （アヤメ）のデータセットを使います。
このデータには、がくの長さ(`Sepal.Length`)、がくの幅(`Sepal.Width`)、花びらの長さ(`Petal.Length`)、花びらの幅(`Petal.Width`)、そして品種(`Species`)の情報が含まれています。

## 図の骨格を作る

`ggplot2` での作図は、以下の3つの基本要素から始まります。

- `ggplot()`: グラフのキャンバスを用意し、使用するデータを指定します。
- `aes()`: エステティック (aesthetics) の略で、データ内のどの変数を、グラフのどの視覚的要素（x軸、y軸、色、形など）に対応させるかを指定します。
- `geom_\*()`: 図形 (geometry) の略で、どのような形のグラフを描くか（点、線、棒など）を指定します。今回は点プロットなので `geom_point()` を使います。

これらを `+` で繋げて、がくの長さと幅の関係を見てみましょう。

```{r}
ggplot(data = iris, 
       aes(
         x = Sepal.Length, 
         y = Sepal.Width)) +
  geom_point()
```

##　`aes()` で色分けする

`ggplot2` の真価は、データの変数に基づいて自動で視覚的属性を割り当てられる点にあります。
`aes()` の中で `color = Species` と指定するだけで、`iris` の品種 (`Species`) ごとに自動で点の色分けと凡例の作成が行われます。

```{r}
ggplot(data = iris, 
       aes(
         x = Sepal.Length, 
         y = Sepal.Width, 
         color = Species)) +
  geom_point()
```

## `aes()` で形やサイズも変える

同様に、`shape` (形) や `size` (大きさ) などの属性も `aes()` の中で指定できます。

```{r}
ggplot(data = iris, 
       aes(
         x = Sepal.Length, 
         y = Sepal.Width, 
         color = Species, 
         shape = Species)) +
  geom_point(size = 3) # 点の基本サイズを少し大きくする
```

## 全体の色や透明度を固定する

もし、データに応じて色を変えるのではなく、すべての点の色を特定の色に固定したい場合は、`aes()` の外で指定します。これは `ggplot2` を使う上で非常に重要なルールです。

`alpha` は透明度を指定する属性で、`0` (完全に透明) から `1` (完全に不透明) の間の値を指定します。点が重なっている場合に有効です。


```{r}
ggplot(data = iris, 
       aes(
         x = Sepal.Length, 
         y = Sepal.Width)) +
  geom_point(
    color = "blue",
    size = 3, 
    alpha = 0.5)

```

